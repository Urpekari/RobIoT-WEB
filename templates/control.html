<!DOCTYPE html>
<html>
<head>
    <title>Root</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">
    {{ header|safe }}

</head>
<body>
    <div>
        <button onclick="traducir('es')">Español</button>
        <button onclick="traducir('en')">Inglés</button>
        <button onclick="traducir('eu')">Euskera</button>
    </div>
    <div class="map">
        {{ body_html|safe }}
        <script>
            {{ script|safe }}
        </script>      
    </div>
    <div class="mezuen-taula">
        <h2 class="izenburu" data-i18n="mezu">Azken mezu esanguratsuak:</h2>
        <table>
            <thead>
                <th>Timestamp</th>
                <th>Dronea</th>
                <th>Noranzkoa</th>
                <th>Mezua</th>
            </thead>
            <tbody>
                {% for row in mezu %}
                <tr>
                    {% for column in row %}
                    <td>{{ column }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="informazioaren-taula">
        <h1 data-i18n="ver">Ikusten:</h1><h1> {{dronea}}:</h1>
        <table>
            <thead class="taula">
                <tr>
                    <th>Xehetasunak</th>
                    <th>Timestamp</th>
                </tr> 
            </thead>
            <tbody class="taula">
                <tr>
                    <td>Position</td>
                    <td>{{timestamp}}</td>
                </tr>
                <tr>
                    <td>{{lat}} N</td><!--Orain dronak duen posizioa sartu-->
                    <td>{{lng}} W</td>
                </tr>
                <tr>
                    <td>Next Waypoint</td>
                    <td>ETA: </td>
                </tr>
                <tr>
                    <td>     N</td>
                    <td>     W</td>
                </tr>
                <tr>
                    <td>Destination</td>
                    <td>ETA: </td>
                </tr>
                <tr>
                    <td>     N</td>
                    <td>     W</td>
                </tr>
            </tbody>
        </table>
    <br>
    <table>

        <tr>
            <td>
                {%if ikusi%}
                    <a href="{{url_for('insert_path',drone=dronea)}}">
                        <button data-i18n="add">Ibilbidea gehitu</button>
                    </a>
                {%endif%}
            </td>
            <td>
                <a href="/">
                    <button data-i18n="ez">Ezeztatu</button>
                </a>
            </td>
        </tr>
        <tr>
            <td>
                <a href="/">
                    <button data-i18n="back">Bueltatu etxera</button>
                </a>
            </td>
            <td>
                <a href="/">
                    <button data-i18n="ctr">Kontrolak</button>
                </a>
            </td>
        </tr>
    
    </table>
</div>
    <div class="dronen-taula">
        <h1 data-i18n="lst">Dronen zerrenda:</h1>
        <table>
            <thead class="taula">
                <th>Dronea</th>
            </thead>
            <tbody class="taula">
                {% for row in droneak %}
                <tr>
                    <td>
                        <form action="/control" method="post">
                            <input type="hidden" name="drone_izena" value="{{ row }}">
                            <button class="link-button" name="botoia" value="1">{{ row }}</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <br>
        <a href="/insert-drone">
            <button data-i18n="add2">Gehitu dronea</button>
        </a>
    </div>
    <script>
        let diccionario = {};
    
        // Cargar el archivo JSON al cargar la página
          fetch("{{ url_for('static', filename='traducciones.json') }}")
          .then(res => res.json())
          .then(data => {
            diccionario = data;
            traducir("eu"); // Idioma por defecto
          });
    
        function traducir(idioma) {
          document.querySelectorAll("[data-i18n]").forEach(el => {
            const clave = el.getAttribute("data-i18n");
            el.textContent = diccionario[idioma][clave] || clave;
          });
        }
      </script>
</body>
</html>
